<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EyesEverywhere</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- TOPO COM VÍDEO DE FUNDO -->
  <div class="topo-com-video" style="position: relative; height: 100vh; overflow: hidden;">
    <video autoplay muted loop playsinline style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0;">
      <source src="imagens/videos.mp4" type="video/mp4">
      O seu navegador não suporta vídeo HTML5.
    </video>

    <header style="position: relative; z-index: 1; background: transparent; display: flex; justify-content: space-between; align-items: center; padding: 15px 50px; color: white;">
  <div class="logo">
    <a href="index.html">
      <img src="imagens/logo.png" alt="EyesEverywhere" style="height: 90px;" />
    </a>
  </div>

  <nav style="flex: 1;">
    <ul style="list-style: none; display: flex; justify-content: center; margin: 0; padding: 0; gap: 25px;">
      <li><a href="sobre.html" style="color: white; font-weight: bold; text-decoration: none;">SOBRE NÓS</a></li>
      <li><a href="comooperamos.html" style="color: white; font-weight: bold; text-decoration: none;">COMO OPERAMOS</a></li>
      <li><a href="ocorrencias.html" style="color: white; font-weight: bold; text-decoration: none;">OCORRÊNCIAS</a></li>
      <li><a href="contactos.html" style="color: white; font-weight: bold; text-decoration: none;">CONTACTOS</a></li>
    </ul>
  </nav>

  <!-- Login/Logout dinâmico -->
  <div style="display: flex; align-items: center; gap: 15px;">
    <div class="auth-links" style="color: white; font-weight: bold; font-size: 16px;">
      <a href="signup.html">SIGN UP</a> | 
      <a href="login.html">LOG IN</a>
    </div>

    <div class="user-area" style="display: flex; align-items: center; gap: 12px; color: white; font-weight: bold; font-size: 16px;">
      <span id="user-info"></span>
      <div class="notificacoes">
        <div class="icon-wrapper">
          <img src="imagens/sinoindex.png" alt="Notificações" class="icon-sino" style="width: 24px;">
          <span class="contador" id="contador-notificacoes">2</span>
        </div>
       <div id="caixa-notificacoes" class="caixa-notificacoes oculto">
        </div>
      </div>
      <button id="logout-btn" style="display: none; background: none; border: none; color: white; font-weight: bold; font-size: 16px; cursor: pointer;">| Logout</button>
    </div>
  </div>
</header>

  </div>


<!-- Botão para ver informações atualizadas -->
<div class="botao-informacoes" style="position: absolute; top: 90%; right: 5%; z-index: 2;">
  <button id="scrollButton" style="padding: 15px 30px; background-color: #f4a261; color: white; font-size: 18px; border: none; border-radius: 10px; cursor: pointer; transition: background-color 0.3s; display: flex; align-items: center; justify-content: center;">
    <i class="fas fa-arrow-down" style="font-size: 18px;"></i> <!-- Seta -->
  </button>
</div>

<!-- Script para fazer scroll ao clicar no botão-->
<script>
  document.getElementById('scrollButton').addEventListener('click', function() {
    // Rolagem suave para a seção de "Estatísticas"
    document.querySelector('.estatisticas').scrollIntoView({
      behavior: 'smooth'
    });
  });
</script>

    <!-- ESTATÍSTICAS -->
    <section class="estatisticas">
      <div class="estatistica-box">
        <div class="icone-circulo"><i class="fas fa-search"></i></div>
        <h3>320</h3>
        <p>Auditorias Realizadas</p>
      </div>
      <div class="estatistica-box">
        <div class="icone-circulo"><i class="fas fa-exclamation-circle"></i></div>
        <h3>1.200</h3>
        <p>Ocorrências Reportadas</p>
      </div>
      <div class="estatistica-box">
        <div class="icone-circulo"><i class="fas fa-check-circle"></i></div>
        <h3>950</h3>
        <p>Ocorrências Resolvidas</p>
      </div>
      <div class="estatistica-box" id="box-em-analise">
        <div class="icone-circulo"><i class="fas fa-hourglass-half"></i></div>
        <h3>0</h3>
        <p>Ocorrências em Análise</p>
      </div>
      <div class="estatistica-box">
        <div class="icone-circulo"><i class="fas fa-clock"></i></div>
        <h3>48h</h3>
        <p>Tempo Médio de Resposta</p>
      </div>
      <div class="estatistica-box" data-total="0">
        <div class="icone-circulo"><i class="fas fa-smile-beam"></i></div>
        <h3>97%</h3>
        <p>Satisfação dos Cidadãos</p>
      </div>
    </section>

    <!-- ATUALIZAÇÕES -->
    <section class="atualizacoes">
        <div class="titulo-atualizacoes">
          <h2>Conteúdo Relevante e Atualizado</h2>
          <div class="linha-decorativa"></div>
          <p>Mantenha-se informado com as últimas atualizações da EyesEverywhere.</p>
        </div>
      
        <div class="noticias-cards">
          <div class="noticia">
            <span class="data">17/04</span>
            <p class="texto">Finalizamos parceria com a Câmara Municipal de Braga.</p>
          </div>
          <div class="noticia">
            <span class="data">15/04</span>
            <p class="texto">100% das ocorrências em Guimarães resolvidas.</p>
          </div>
          <div class="noticia">
            <span class="data">13/04</span>
            <p class="texto">Novo sistema de auditoria foi implementado com sucesso.</p>
          </div>
        </div>
      </section>
      

    <!-- GRÁFICO DONUT -->
    <section class="grafico-distribuicao">
        <div class="titulo-atualizacoes">
          <h2>Distribuição dos Conteúdos</h2>
          <div class="linha-decorativa"></div>
          <p>Uma visão geral das principais áreas de atualização da EyesEverywhere.</p>
        </div>
      
        <div class="grafico-container">
          <canvas id="graficoDonut"></canvas>
          <ul class="legenda-grafico">
            <li><span style="background-color: #f4a261;"></span> Parcerias (30%)</li>
            <li><span style="background-color: #2a9d8f;"></span> Ocorrências Resolvidas (25%)</li>
            <li><span style="background-color: #e76f51;"></span> Auditorias (15%)</li>
            <li><span style="background-color: #264653;"></span> Eventos Públicos (20%)</li>
            <li><span style="background-color: #e9c46a;"></span> Sensibilização (10%)</li>
          </ul>
        </div>
      </section>
      

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('graficoDonut').getContext('2d');
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Parcerias', 'Ocorrências Resolvidas', 'Auditorias', 'Eventos Públicos', 'Sensibilização'],
        datasets: [{
          data: [30, 25, 15, 20, 10],
          backgroundColor: ['#f4a261', '#2a9d8f', '#e76f51', '#264653', '#e9c46a'],
          borderWidth: 0
        }]
      },
      options: {
        cutout: '65%',
        plugins: {
          legend: { display: false },
          tooltip: {
            enabled: true,
            backgroundColor: '#fff',
            titleColor: '#000',
            bodyColor: '#000',
            borderColor: '#a46834',
            borderWidth: 1,
            titleFont: {
              size: 16,
              weight: 'bold'
            },
            bodyFont: {
              size: 14
            },
            padding: 12,
            cornerRadius: 6,
            displayColors: true,
            callbacks: {
              label: function(context) {
                return `${context.label}: ${context.formattedValue}%`;
              }
            }
          }
        }
      }
    });
  </script>

<section class="faq">
  <h2 class="titulo">Perguntas Frequentes</h2>
  <div class="faq-item">
    <h3 class="faq-pergunta" onclick="toggleResposta(1)">
      Como posso relatar uma ocorrência? <i class="fas fa-chevron-down"></i>
    </h3>
    <p class="faq-resposta" id="resposta1">Você pode relatar uma ocorrência diretamente no nosso site, na seção "Ocorrências". Basta preencher o formulário com os detalhes necessários, e a nossa equipa irá processá-la imediatamente.</p>
  </div>
  <div class="faq-item">
    <h3 class="faq-pergunta" onclick="toggleResposta(2)">
      Como sei que minha ocorrência foi resolvida? <i class="fas fa-chevron-down"></i>
    </h3>
    <p class="faq-resposta" id="resposta2">Assim que sua ocorrência for resolvida, você receberá uma notificação por e-mail ou pelo nosso sistema, com os detalhes da resolução.</p>
  </div>
  <div class="faq-item">
    <h3 class="faq-pergunta" onclick="toggleResposta(3)">
      Quais são os horários de atendimento da EyesEverywhere? <i class="fas fa-chevron-down"></i>
    </h3>
    <p class="faq-resposta" id="resposta3">O nosso horário de atendimento é de segunda a sexta-feira, das 08h00 às 12h00 e das 14h00 às 18h00.</p>
  </div>
  <div class="faq-item">
    <h3 class="faq-pergunta" onclick="toggleResposta(4)">
      Como posso entrar em contato com a empresa? <i class="fas fa-chevron-down"></i>
    </h3>
    <p class="faq-resposta" id="resposta4">Você pode entrar em contato conosco através dos nossos canais de atendimento, disponíveis na seção "Contactos" do nosso site, ou através do telefone +351 253 589 366 e e-mail info@eyeseverywhere.pt.</p>
  </div>
</section>

<script>
 function toggleResposta(id) {
  var resposta = document.getElementById('resposta' + id);
  var pergunta = document.querySelector('.faq-pergunta:nth-child(' + id + ')');
  
  // Exibir ou esconder a resposta
  resposta.style.display = (resposta.style.display === 'none' || resposta.style.display === '') ? 'block' : 'none';
  
  // Adiciona a classe para girar a seta
  pergunta.classList.toggle('open');
}
  
</script>

<body>
  <!-- Mensagem de feedback -->
  <div id="feedback-message" class="feedback-message"></div>

  <!-- FORMULÁRIO DE AVALIAÇÃO -->
  <section class="avaliacao-contactos-container">
    <div class="avaliacao-container">
      <form class="avaliacao-form">
        <h2>Avalie-nos</h2>
        <p>A sua opinião é essencial para continuarmos a melhorar.</p>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" placeholder="O seu nome" />

        <label for="email">Email:</label>
        <input type="email" id="email" placeholder="O seu email" />

        <select id="avaliacao">
        <option value="">Selecione</option>
        <option value="Excelente">Excelente</option>
        <option value="Bom">Bom</option>
        <option value="Razoável">Razoável</option>
        <option value="Mau">Mau</option>
        </select>


        <label for="comentarios">Comentários adicionais:</label>
        <textarea id="comentarios" placeholder="Escreva aqui a sua opinião..."></textarea>

        <button type="submit">Submeter Avaliação</button>
      </form>
    </div>

    <!-- Outras secções como contactos, redes sociais, mapa, etc. -->
  </section>

  <!-- SCRIPT PARA AVALIAÇÃO -->
  <script>
  const valoresAvaliacao = {
    'Excelente': 100,
    'Bom': 75,
    'Razoável': 50,
    'Mau': 25
  };

  let avaliacoes = JSON.parse(localStorage.getItem('avaliacoes')) || [];

  function showFeedbackMessage(message, type = 'success') {
    const feedbackMessage = document.getElementById('feedback-message');
    feedbackMessage.innerHTML = message;
    feedbackMessage.className = 'feedback-message ' + type;
    feedbackMessage.style.display = 'flex';

    setTimeout(() => {
      feedbackMessage.style.display = 'none';
    }, 3000);
  }

  function calcularSatisfacao() {
    if (avaliacoes.length === 0) return 0;
    const total = avaliacoes.reduce((sum, av) => sum + valoresAvaliacao[av.avaliacao], 0);
    return Math.round(total / avaliacoes.length);
  }

  function atualizarDisplaySatisfacao() {
    const percentagem = calcularSatisfacao();
    const box = document.querySelector('.estatistica-box:last-child');
    if (box) {
      box.querySelector('h3').textContent = `${percentagem}%`;
      box.setAttribute('data-total', avaliacoes.length);
    }
  }

  document.addEventListener('DOMContentLoaded', function () {
    atualizarDisplaySatisfacao();

    const form = document.querySelector('.avaliacao-form');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const nome = document.getElementById('nome').value.trim();
      const email = document.getElementById('email').value.trim();
      const avaliacao = document.getElementById('avaliacao').value;
      const comentarios = document.getElementById('comentarios').value.trim();

      if (avaliacao === '') {
        showFeedbackMessage('Por favor, selecione uma avaliação', 'warning');
        return;
      }

      avaliacoes.push({ nome, email, avaliacao, comentarios, data: new Date() });
      localStorage.setItem('avaliacoes', JSON.stringify(avaliacoes));
      atualizarDisplaySatisfacao();
      form.reset();
      showFeedbackMessage('Obrigado pela sua avaliação!', 'success');
    });
  });
</script>

</body>

      <!-- CONTACTOS + REDES + MAPA (lado direito) -->
      <div class="contactos-lado-direito">
        <div class="info-blocos">
          <div class="info-bloco">
            <h3>Horários</h3>
            <p>Seg. a Sexta</p>
            <p>08h00 – 12h00</p>
            <p>14h00 – 18h00</p>
          </div>
          <div class="info-bloco">
            <h3>Sede</h3>
            <p>Alameda de São Dâmaso 45,</p>
            <p>4810-286 Guimarães</p>
          </div>
          <div class="info-bloco">
            <h3>Contactos</h3>
            <p><i class="fas fa-phone"></i> +351 253 589 366</p>
            <p><i class="fas fa-envelope"></i> info@eyeseverywhere.pt</p>

          </div>
        </div>
      
      <div class="social-media" style="display: flex; justify-content: center; gap: 30px;">
        <i class="fab fa-facebook" style="color: #a46834; font-size: 25px;" onmouseover="this.style.color='#f4a261'" onmouseout="this.style.color='#a46834'"></i>
        <i class="fab fa-instagram" style="color: #a46834; font-size: 25px;" onmouseover="this.style.color='#f4a261'" onmouseout="this.style.color='#a46834'"></i>
        <i class="fab fa-twitter" style="color: #a46834; font-size: 25px;" onmouseover="this.style.color='#f4a261'" onmouseout="this.style.color='#a46834'"></i>
      </div>

        <div class="map-container">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3123.931517447219!2d-8.289683484309572!3d41.4440703792606!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd24f61b7dbb50ab%3A0x21b3ef7a923d8c9a!2sAlameda%20de%20S%C3%A3o%20D%C3%A2maso%2045%2C%204810-286%20Guimar%C3%A3es!5e0!3m2!1spt-BR!2spt!4v1712345678901"
            width="80%" 
            height="250"  
            style="border:0;" 
            allowfullscreen="" 
            loading="lazy">
          </iframe>
        </div>
      </div>
      
  </section>

  <script>

    // Função para calcular a satisfação média
    function calcularSatisfacao() {
      if (avaliacoes.length === 0) return 0; // Valor padrão se não houver avaliações
      
      const total = avaliacoes.reduce((sum, av) => sum + valoresAvaliacao[av.avaliacao], 0);
      return Math.round(total / avaliacoes.length);
    }
  
    // Atualiza o display da satisfação
    function atualizarDisplaySatisfacao() {
      const percentagem = calcularSatisfacao();
      const box = document.querySelector('.estatistica-box:last-child');
      box.querySelector('h3').textContent = `${percentagem}%`;
      box.setAttribute('data-total', avaliacoes.length);
    }
  
  </script>

<script>
  // Guardar as estatísticas fixas no localStorage (exceto satisfação dos cidadãos)
  function guardarEstatisticasFixas() {
    const estatisticas = document.querySelectorAll('.estatistica-box');
    const chaves = [
    'auditorias_realizadas',
    'ocorrencias_reportadas',
    'ocorrencias_resolvidas',
    'tempo_medio_resposta',
    'ocorrencias_em_analise'
    ];


    // Só percorre os 4 primeiros elementos (índices 0 a 3)
    estatisticas.forEach((box, index) => {
      if (index < chaves.length) {
        const valor = box.querySelector('h3').textContent.trim();
        localStorage.setItem(chaves[index], valor);
      }
    });
  }

  // Executar ao carregar a página, após tudo estar carregado
  window.addEventListener('DOMContentLoaded', () => {
    guardarEstatisticasFixas(); // guarda as 4 estatísticas
    atualizarDisplaySatisfacao(); // função já existente, não será anulada
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    guardarEstatisticasFixas(); 
    atualizarDisplaySatisfacao(); 

    // Cálculo automático de Ocorrências em Análise
    const reportadas = parseInt(localStorage.getItem('ocorrencias_reportadas')?.replace(/\./g, '')) || 0;
    const resolvidas = parseInt(localStorage.getItem('ocorrencias_resolvidas')?.replace(/\./g, '')) || 0;

    const emAnalise = reportadas - resolvidas;

    localStorage.setItem('ocorrencias_em_analise', emAnalise);

    const box = document.querySelector('#box-em-analise h3');
    if (box) box.textContent = emAnalise;
  });
</script>

<script>
  window.onload = function() {
  // Código para mostrar utilizador logado e controlo de login/logout
  const userName = localStorage.getItem("userName");
  const authLinks = document.querySelector(".auth-links");
  const userInfo = document.getElementById("user-info");
  const logoutBtn = document.getElementById("logout-btn");
  const userArea = document.querySelector(".user-area");

  if (userName) {
    if (authLinks) authLinks.style.display = "none";
    if (userInfo) userInfo.textContent = `Olá, ${userName}`;
    if (logoutBtn) logoutBtn.style.display = "inline";
    if (userArea) userArea.style.display = "flex";
  } else {
    if (authLinks) authLinks.style.display = "flex";
    if (userArea) userArea.style.display = "none";
  }

  if (logoutBtn) {
    logoutBtn.addEventListener("click", function () {
      localStorage.removeItem("userName");
      window.location.href = "index.html";
    });
  }

  // Código para mostrar notificações
  mostrarNotificacoes();

  // Código para outras funcionalidades no onload (scroll, estatísticas, etc)
  const scrollBtn = document.getElementById("scrollButton");
  if (scrollBtn) {
    scrollBtn.addEventListener("click", function () {
      document.querySelector(".estatisticas").scrollIntoView({ behavior: "smooth" });
    });
  }

  atualizarDisplaySatisfacao();
};

    const scrollBtn = document.getElementById("scrollButton");
    if (scrollBtn) {
      scrollBtn.addEventListener("click", function () {
        document.querySelector(".estatisticas").scrollIntoView({ behavior: "smooth" });
      });
    }
    
    atualizarDisplaySatisfacao();
</script>

<script>
  function contarVisitaHoje() {
    const hoje = new Date().toLocaleDateString(); // Ex: "19/05/2025"
    const dataGuardada = localStorage.getItem("data_visitas_index");

    // Se for um novo dia, reinicia o contador
    if (dataGuardada !== hoje) {
      localStorage.setItem("data_visitas_index", hoje);
      localStorage.setItem("visitas_index_hoje", 1);
    } else {
      // Se for o mesmo dia, incrementa
      let visitas = parseInt(localStorage.getItem("visitas_index_hoje")) || 0;
      visitas++;
      localStorage.setItem("visitas_index_hoje", visitas);
    }
  }

  window.addEventListener("DOMContentLoaded", contarVisitaHoje);
</script>


<script>
  
  const notificacoesPadrao = [
    { estado: "Aceite", descricao: "Buraco na estrada" },
    { estado: "Rejeitada", descricao: "Falha no passeio" }
  ];

  function carregarNotificacoes() {
    let notificacoes = JSON.parse(localStorage.getItem("notificacoes"));
    if (!notificacoes || !Array.isArray(notificacoes) || notificacoes.length === 0) {
      notificacoes = notificacoesPadrao;
      localStorage.setItem("notificacoes", JSON.stringify(notificacoes));
    }
    return notificacoes;
  }

  function mostrarNotificacoes() {
    const notificacoes = carregarNotificacoes();
    const caixa = document.getElementById("caixa-notificacoes");
    const contador = document.getElementById("contador-notificacoes");

    caixa.innerHTML = ""; // limpa conteúdo
    notificacoes.forEach(n => {
      const p = document.createElement("p");
      p.innerHTML = `<strong>Ocorrência:</strong> ${n.estado} - ${n.descricao}`;
      caixa.appendChild(p);
    });

    if (contador) {
      contador.textContent = notificacoes.length;
    }
  }


    // Teu código onload original (userName, authLinks, logout, scroll, etc) aqui
    // ...
</script>
</body>

 
</body>
</html>
